# Задание

В этой лабораторной работе вы будете работать с данными, а точнее большим количеством данных.
Для работы вам понадобиться знакомство с пакетами [json](https://docs.python.org/3/library/json.html) 
и дополнительным пакетом [xlsxwriter](https://xlsxwriter.readthedocs.io/getting_started.html)

### Исходные файлы
В директории вы можете найти несколько исходных файлов c данными:
- **clients.json**
- **payments.json**

Данный файлы это выгрузка из некоторой базы данных, ваша задача используя эту выгрузку сгенерировать Excel файл с отчётом для аналитиков.
Пример файла и его формат также приведён в репозитории **payments_analytics.xlsx**.  

Последний файл является тем который вы должны в итоге получить.
______________________________________________________________________________
Вам необходимо сформировать следующий набор блоков с данными и записать их в файл `my_payments_analytics_<year>_<month>_<day>.xlsx`, 
файл должен создаваться при запуске файла с решением `main.py` в директории с решением (`solution`).
Файл также должен быть снабжён меткой времени создания.

Сам файл должен быть разбит на блоки:
1) **Описание выгрузки**
2) **Отчёт по активным клиентам** - вам необходимо проанализировать платежи клиентов по квартально и вывести топ 10 плательщиков, стартовым кварталом считайте дату самого позднего платежа.
3) **География клиентов** - выведите топ 10 городов по количеству клиентов, вместе с этим количеством
4) **Анализ состояния счёта** - анализ состояния счёт клиента на текущий момент в двух градациях топ **10 задолжников** и топ **10 клиентов** с самым большим балансом на счету. Будем считать, что изначально у каждого клиента на счету был 0, каждый положительный платёж это зачисление, отрицательный - списание.

______________________________________________________________________________
### При чём здесь ООП
Внимательный зритель мог заметить, что весь документ разбит на блоки, а значит логика записи в целом будет совпадать.  
*Маленькая подсказка:*

Вы можете создать абстрактный класс блока:
```python
from abc import ABCMeta


class BaseXlsBlock(metaclass=ABCMeta):
    NAME = "Block"
    
    
```

1) В нём вы можете определить все формат для ячеек, базовые методы для записей заголовков блока и вещи которые будут повторяться от раза к разу
2) Затем вы можете создавать класс под каждый блок отдельно и наполнять его описанием записи в excel.
3) После того как вы соберёте блоки им явно понадобиться какая-то информация сверху. Блоки это всего лишь механизмы и ими кто-то должен управлять и вызвать.

Собствено вот он этот кто-то, именно этот класс вы будете вызывать в файле **main.py**.
```python
class XlsAnalyticPaymentWriter:
    ANALYTICS_BLOCKS_CLASSES = [
        HeaderBlock,
        QuartetPaymentBlock,
        BankAccountBlock
    ]
```

Bот он ООП во всей своей красе и соблюдение одного из принципов [SOLID](https://tproger.ru/articles/principy-solid-python?ysclid=lpegafv99u383195577)
Если все ваши классы с суффиксом `Block` имеют один и тот же интерфейс то вы можете довольно лего передавать им данные из одного источника и вызывать функции и методы которые у данных классов одинаковые.

### Это действительно сложная и нетривиальная задача, вы с ней справитесь








